<!DOCTYPE html>
<html lang="en" ng-app="A2ADemoApp">
<head>
  <meta charset="UTF-8" />
  <title>A2A Demo Interface</title>

  <!-- 1) AngularJS -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>

  <!-- 2) Load the ESM client and attach to window -->
  <script type="module">
    import { A2AClient } from './a2a-client.js';
    // expose for your non-module app.js
    window.A2AClient = A2AClient;
  </script>

  <!-- 3) Your application script (unchanged) -->
  <script src="app.js"></script>

  <style>
    body { font-family: Arial, sans-serif; margin: 20px; max-width: 600px; }
    select, input, button { font-size: 1em; }
    #messages {
      border: 1px solid #ccc;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      white-space: pre-wrap;
    }
    .msg-user { font-weight: bold; }
    .msg-agent { margin-left: 20px; }
    .artifact-link {
      display: block;
      margin-left: 20px;
      color: blue;
      text-decoration: underline;
      cursor: pointer;
    }
  </style>
</head>
<body ng-controller="ChatController">
  <h1>A2A Demo UI</h1>
  <p>Select an agent to chat with, then enter a message:</p>

  <div>
    <label for="agentSelect"><strong>Agent:</strong></label>
    <select id="agentSelect"
            ng-model="selectedAgent"
            ng-options="agent.name for agent in agents">
    </select>
  </div>

  <div style="margin: 10px 0;">
    <input type="text"
           ng-model="userQuery"
           placeholder="Type your message..."
           style="width:80%;" />
    <button ng-click="sendMessage()">Send</button>
  </div>

  <div id="messages">
    <div ng-repeat="msg in chatLog">
      <span class="msg-{{msg.role}}">{{msg.role}}:</span> {{msg.text}}
    </div>
    <div ng-repeat="file in artifacts">
      <a class="artifact-link"
         ng-href="{{file.dataURL}}"
         ng-download="{{file.filename}}"
         ng-show="file.dataURL">
        ðŸ“Ž Download "{{file.filename}}"
      </a>
    </div>
  </div>
</body>
</html>
